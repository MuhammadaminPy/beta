<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <!-- ‚öôÔ∏è –ù–ê–°–¢–†–û–ô–ö–ê: –∑–∞–º–µ–Ω–∏—Ç–µ URL –Ω–∞ –∞–¥—Ä–µ—Å –≤–∞—à–µ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞ FastAPI (bot.py) -->
    <!-- –ï—Å–ª–∏ —Ñ—Ä–æ–Ω—Ç –∏ –±—ç–∫ –Ω–∞ –æ–¥–Ω–æ–º —Å–µ—Ä–≤–µ—Ä–µ ‚Äî –æ—Å—Ç–∞–≤—å—Ç–µ /api -->
    <!-- –ï—Å–ª–∏ —Ä–∞–∑–Ω—ã–µ —Å–µ—Ä–≤–µ—Ä—ã ‚Äî —É–∫–∞–∂–∏—Ç–µ –ø–æ–ª–Ω—ã–π URL: https://your-domain.com/api -->
    <meta name="api-base" content="https://beta-production-5976.up.railway.app/">
    <title>Gifts Tycoon</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div id="loading-screen">
        <div class="load-logo">‚õèÔ∏è</div>
        <div class="load-title">GIFTS TYCOON</div>
        <div class="load-bar-wrap"><div class="load-bar" id="load-bar"></div></div>
        <div class="load-text">–ó–∞–≥—Ä—É–∑–∫–∞ —à–∞—Ö—Ç—ã...</div>
    </div>

    <div id="app" class="hidden">
        <div id="hud">
            <div class="hud-coins">
                <div class="hud-coin-item"><span class="coin-icon">ü™ô</span><span id="hud-normal">0</span></div>
                <div class="hud-coin-item"><span class="coin-icon">ü•à</span><span id="hud-silver">0</span></div>
                <div class="hud-coin-item"><span class="coin-icon">üèÖ</span><span id="hud-gold">0</span></div>
            </div>
            <div class="hud-storage" onclick="openShop()">
                <div class="hud-storage-label">–°–ö–õ–ê–î <span id="hud-cur">0</span>/<span id="hud-max">200</span> <span style="color:#FFD700;font-size:9px">üõí</span></div>
                <div class="hud-storage-track"><div class="hud-storage-fill" id="hud-sfill"></div></div>
            </div>
            <div class="hud-right">
                <div id="happy-hour-badge" class="happy-badge hidden">‚ö° HAPPY!</div>
            </div>
        </div>
        <div id="boost-timer" style="display:none;background:linear-gradient(90deg,#E65100,#FF6D00);color:#fff;font-family:'Courier New',monospace;font-size:10px;text-align:center;padding:3px;letter-spacing:1px;"></div>

        <div id="game-screen" class="screen active">
            <canvas id="game-canvas"></canvas>
            <div class="scroll-arrow">‚ñº –õ–ò–°–¢–ê–ô –í–ù–ò–ó ‚ñº</div>

            <div id="upgrade-panel" class="upgrade-panel hidden">
                <div class="upgrade-panel-inner">
                    <div class="upgrade-header">
                        <span id="upgrade-title">–£–ª—É—á—à–µ–Ω–∏–µ</span>
                        <button class="close-btn" onclick="closeUpgradePanel()">‚úï</button>
                    </div>
                    <div id="upgrade-content"></div>
                </div>
            </div>
        </div>

        <div id="research-screen" class="screen hidden">
            <div class="coming-soon-wrap">
                <div class="cs-emoji">üî≠</div>
                <div class="cs-title">–ò–°–°–õ–ï–î–û–í–ê–ù–ò–Ø</div>
                <div class="cs-sub">–°–ö–û–†–û...</div>
                <div class="cs-desc">–ù–æ–≤—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ –¥–æ–±—ã—á–∏ –∏ —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –±–æ–Ω—É—Å—ã —É–∂–µ –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ!</div>
            </div>
        </div>

        <div id="miners-screen" class="screen hidden">
            <div class="lb-header"><h2>üèÜ –¢–û–ü –ú–ê–ô–ù–ï–†–´</h2></div>
            <div class="lb-tabs">
                <button class="lb-tab active" onclick="switchLbTab('normal',this)">ü™ô –û–±—ã—á–Ω—ã–µ</button>
                <button class="lb-tab" onclick="switchLbTab('silver',this)">ü•à –°–µ—Ä–µ–±—Ä–æ</button>
                <button class="lb-tab" onclick="switchLbTab('gold',this)">üèÖ –ó–æ–ª–æ—Ç–æ</button>
            </div>
            <div id="lb-list" class="lb-list"><div class="lb-loading">–ó–ê–ì–†–£–ó–ö–ê...</div></div>
        </div>

        <div id="craft-screen" class="screen hidden">
            <div class="craft-wrap">
                <div class="craft-title">‚öóÔ∏è –ö–£–ó–ù–ò–¶–ê</div>
                <div class="craft-info">–í—ã–±–µ—Ä–∏—Ç–µ —Ä–µ—Ü–µ–ø—Ç –∏ –¥–æ–±–∞–≤—å—Ç–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã</div>
                <div class="recipe-tabs">
                    <button class="recipe-tab active" onclick="selectRecipe('normal',this)">ü™ô ‚Üí ü•à<br><span style="font-size:9px;opacity:0.6">8 –æ–±—ã—á–Ω—ã—Ö ‚Üí 1 —Å–µ—Ä–µ–±—Ä–æ</span></button>
                    <button class="recipe-tab" onclick="selectRecipe('silver',this)">ü•à ‚Üí üèÖ<br><span style="font-size:9px;opacity:0.6">4 —Å–µ—Ä–µ–±—Ä–∞ ‚Üí 1 –∑–æ–ª–æ—Ç–æ</span></button>
                </div>
                <div class="forge-container">
                    <div class="forge-grid" id="forge-grid">
                        <div class="forge-slot" id="slot-0" onclick="toggleSlot(0)"><span class="plus-icon">+</span></div>
                        <div class="forge-slot empty-cell"></div>
                        <div class="forge-slot" id="slot-1" onclick="toggleSlot(1)"><span class="plus-icon">+</span></div>
                        <div class="forge-slot empty-cell"></div>
                        <div class="forge-result-cell" id="forge-result">?</div>
                        <div class="forge-slot empty-cell"></div>
                        <div class="forge-slot" id="slot-2" onclick="toggleSlot(2)"><span class="plus-icon">+</span></div>
                        <div class="forge-slot empty-cell"></div>
                        <div class="forge-slot" id="slot-3" onclick="toggleSlot(3)"><span class="plus-icon">+</span></div>
                    </div>
                    <div class="forge-hint" id="forge-hint">–ù–∞–∂–º–∏—Ç–µ + —á—Ç–æ–±—ã –¥–æ–±–∞–≤–∏—Ç—å –º–∞—Ç–µ—Ä–∏–∞–ª—ã (2‚Äì4 —Å–ª–æ—Ç–∞)</div>
                    <div class="forge-stats">
                        <span>–®–∞–Ω—Å: <span class="chance" id="forge-chance">‚Äî</span></span>
                        <span id="forge-balance">–ë–∞–ª–∞–Ω—Å: <span id="forge-bal-val">0</span></span>
                    </div>
                    <button class="forge-btn" id="forge-btn" onclick="doForge()" disabled>–°–û–ó–î–ê–¢–¨</button>
                </div>

                <div class="daily-reward-section">
                    <div class="daily-reward-title">üéÅ –ï–ñ–ï–î–ù–ï–í–ù–ê–Ø –ù–ê–ì–†–ê–î–ê</div>
                    <div id="daily-reward-container"></div>
                </div>
            </div>
        </div>

        <div id="profile-screen" class="screen hidden">
            <div class="profile-wrap">
                <div class="profile-header">
                    <div class="profile-avatar">üë§</div>
                    <div>
                        <div class="profile-name" id="profile-name">–ò–≥—Ä–æ–∫</div>
                        <div class="profile-id" id="profile-id">ID: ---</div>
                    </div>
                </div>
                <div class="balance-card">
                    <div class="balance-title">üí∞ –ë–ê–õ–ê–ù–°</div>
                    <div class="balance-row"><span>ü™ô –û–±—ã—á–Ω—ã–µ:</span><b id="prof-normal">0</b></div>
                    <div class="balance-row"><span>ü•à –°–µ—Ä–µ–±—Ä—è–Ω—ã–µ:</span><b id="prof-silver">0</b></div>
                    <div class="balance-row"><span>üèÖ –ó–æ–ª–æ—Ç—ã–µ:</span><b id="prof-gold">0</b></div>
                    <div class="balance-row"><span>üíé TON –∑–∞—Ä–∞–±–æ—Ç–∞–Ω–æ:</span><b id="prof-ton" style="color:#64B5F6">0.0000</b></div>
                </div>
                <div class="profile-actions">
                    <button class="profile-btn exchange-btn" onclick="openExchange()">üí± –û–±–º–µ–Ω –Ω–∞ TON</button>
                    <button class="profile-btn deposit-btn" onclick="openDeposit()">‚≠ê –ü–æ–ø–æ–ª–Ω–∏—Ç—å Stars</button>
                    <button class="profile-btn withdraw-btn" onclick="openWithdraw()">üì§ –í—ã–≤–æ–¥ TON</button>
                    <button class="profile-btn" style="background:linear-gradient(135deg,#1a237e,#283593)" onclick="openShop()">üõí –ú–∞–≥–∞–∑–∏–Ω</button>
                </div>
                <div class="ref-card">
                    <div class="ref-title">üë• –†–ï–§–ï–†–ê–õ–¨–ù–ê–Ø –ü–†–û–ì–†–ê–ú–ú–ê</div>
                    <div class="ref-desc">–ü—Ä–∏–≥–ª–∞—à–∞–π –¥—Ä—É–∑–µ–π ‚Äî –ø–æ–ª—É—á–∞–π –º–æ–Ω–µ—Ç—ã –∑–∞ –∫–∞–∂–¥–æ–≥–æ!<br>–ü–µ—Ä–≤—ã–µ 10 —Ä–µ—Ñ–µ—Ä–∞–ª–æ–≤ –¥–∞—é—Ç +20 –º–µ—Å—Ç —Å–∫–ª–∞–¥–∞ –∫–∞–∂–¥—ã–π.</div>
                    <div class="ref-link-wrap">
                        <div class="ref-link" id="ref-link">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
                        <button class="copy-btn" onclick="copyRefLink()">üìã –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button>
                    </div>
                    <div class="ref-stats">–†–µ—Ñ–µ—Ä–∞–ª–æ–≤: <span class="ref-stats-num" id="ref-count">0</span></div>
                </div>
            </div>
        </div>

        <div id="admin-screen" class="screen hidden">
            <div class="admin-wrap">
                <h2>üîê –ê–î–ú–ò–ù –ü–ê–ù–ï–õ–¨</h2>

                <div class="admin-section">
                    <h3>üìä –®–∞–Ω—Å—ã –º–æ–Ω–µ—Ç (%)</h3>
                    <div class="admin-row"><label>ü™ô –û–±—ã—á–Ω–∞—è:</label><input type="number" id="adm-normal-pct" value="70"></div>
                    <div class="admin-row"><label>ü•à –°–µ—Ä–µ–±—Ä—è–Ω–∞—è:</label><input type="number" id="adm-silver-pct" value="25"></div>
                    <div class="admin-row"><label>üèÖ –ó–æ–ª–æ—Ç–∞—è:</label><input type="number" id="adm-gold-pct" value="5"></div>
                    <button class="admin-btn" onclick="adminSaveRates()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å —à–∞–Ω—Å—ã</button>
                </div>

                <div class="admin-section">
                    <h3>üí± –ö—É—Ä—Å –æ–±–º–µ–Ω–∞ TON</h3>
                    <div class="admin-row"><label>ü•à 1 —Å–µ—Ä–µ–±—Ä–æ = TON:</label><input type="number" id="adm-silver-rate" value="0.001" step="0.0001"></div>
                    <div class="admin-row"><label>üèÖ 1 –∑–æ–ª–æ—Ç–æ = TON:</label><input type="number" id="adm-gold-rate" value="0.005" step="0.0001"></div>
                    <button class="admin-btn" onclick="adminSaveRates()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∫—É—Ä—Å—ã</button>
                </div>

                <div class="admin-section">
                    <h3>‚ö° –°—á–∞—Å—Ç–ª–∏–≤—ã–π —á–∞—Å</h3>
                    <div class="admin-row"><label>–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å (–º–∏–Ω):</label><input type="number" id="adm-happy-duration" value="60"></div>
                    <button class="admin-btn happy-btn" onclick="adminStartHappyHour()">–ó–∞–ø—É—Å—Ç–∏—Ç—å!</button>
                    <div id="happy-status" class="happy-status"></div>
                </div>

                <div class="admin-section">
                    <h3>üë§ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º</h3>
                    <div class="admin-row"><label>Telegram ID:</label><input type="text" id="adm-user-id" placeholder="123456789"></div>
                    <button class="admin-btn" onclick="adminLookupUser()">–ù–∞–π—Ç–∏</button>
                    <div id="adm-user-info" class="adm-user-info hidden">
                        <div class="adm-user-name" id="adm-user-name">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: ---</div>
                        <div id="adm-user-balance" style="font-family:var(--font);font-size:13px;margin-bottom:8px;color:#CCFF90;"></div>
                        <div class="adm-balance-grid">
                            <div><label>ü™ô</label><input type="number" id="adm-give-normal" placeholder="0"></div>
                            <div><label>ü•à</label><input type="number" id="adm-give-silver" placeholder="0"></div>
                            <div><label>üèÖ</label><input type="number" id="adm-give-gold" placeholder="0"></div>
                        </div>
                        <div class="adm-btn-row">
                            <button class="admin-btn" onclick="adminGiveCoins()">‚ûï –ù–∞—á–∏—Å–ª–∏—Ç—å</button>
                            <button class="admin-btn red-btn" onclick="adminRemoveCoins()">‚ûñ –°–ø–∏—Å–∞—Ç—å</button>
                        </div>
                    </div>
                </div>

                <div id="adm-economy-section"></div>
            </div>
        </div>

        <div id="bottom-nav">
            <button class="nav-btn active" onclick="switchScreen('game',this)">
                <span class="nav-icon">‚õèÔ∏è</span><span class="nav-label">–®–∞—Ö—Ç–∞</span>
            </button>
            <button class="nav-btn" onclick="switchScreen('research',this)">
                <span class="nav-icon">üî≠</span><span class="nav-label">–ù–∞—É–∫–∞</span>
            </button>
            <button class="nav-btn" onclick="switchScreen('miners',this)">
                <span class="nav-icon">üèÜ</span><span class="nav-label">–¢–æ–ø</span>
            </button>
            <button class="nav-btn" onclick="switchScreen('craft',this)">
                <span class="nav-icon">‚öóÔ∏è</span><span class="nav-label">–ö—É–∑–Ω–∏—Ü–∞</span>
            </button>
            <button class="nav-btn" onclick="switchScreen('profile',this)">
                <span class="nav-icon">üë§</span><span class="nav-label">–ü—Ä–æ—Ñ–∏–ª—å</span>
            </button>
        </div>
    </div>

    <div id="modal-overlay" class="modal-overlay hidden" onclick="closeModal()">
        <div id="modal-box" class="modal-box" onclick="event.stopPropagation()">
            <div id="modal-content"></div>
        </div>
    </div>

    <div id="toast" class="toast hidden"></div>

    <div id="tutorial-overlay" class="tutorial-overlay hidden">
        <div class="tutorial-box">
            <div class="tut-miner">‚õèÔ∏è</div>
            <div class="tut-bubble" id="tut-bubble"></div>
            <div class="tut-steps" id="tut-steps"></div>
            <button class="tut-next-btn" id="tut-next-btn" onclick="tutNext()">–î–∞–ª–µ–µ ‚Üí</button>
        </div>
    </div>

    <script src="game.js"></script>
</body>
</html>
